<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Konsensus - Website Belajar Blockchain</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="globals.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <style>
        .page-content-wrapper { position: relative; z-index: 10; padding-top: 150px; padding-bottom: 50px; max-width: 1200px; margin: 0 auto; color: #fff; }
        .card { background: rgba(30, 40, 70, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(0, 243, 156, 0.2); margin-bottom: 20px; padding: 20px; border-radius: 10px; }
        .explanation-content h3 { color: #00F39C; margin-top: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 5px; }
        .explanation-content ul, .explanation-content ol { padding-left: 20px; color: #ddd; }
        .wallet-info { background: #fff; color: #333; padding: 10px; border-radius: 5px; text-align: center; }
        .main-button { background: #3498db; color: #fff; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <div class="desktop">
        <img class="gradient" src="images/gradient.jpg" style="height: 100%; position: fixed; object-fit: cover;" />

        <div class="text-wrapper"><a href="index.html">BlockChain</a></div>
        <div class="div"><a href="about.html">About Me</a></div>
        <div class="text-wrapper-2"><a href="index.html">Home</a></div>
        <div class="text-wrapper-3"><a href="hash.html">Hash</a></div>
        <div class="text-wrapper-4"><a href="block.html">Block</a></div>
        <div class="text-wrapper-5"><a href="blockchain.html">Block Chain</a></div>
        <div class="text-wrapper-6"><a href="ecc_signature.html">ECC Signature</a></div>
        <div class="text-wrapper-7"><a href="consensus.html" style="color: #00F39C; font-weight: 700;">Konsensus</a></div>

        <div class="page-content-wrapper container">
            <h2 style="text-align: center;">Simulasi Konsensus</h2>
            
            <section class="card">
                <h3 style="color: #fff;">Status Dompet (User Wallet)</h3>
                <div id="walletContainer" style="display: flex; gap: 15px; justify-content: space-around; margin-top: 15px;"></div>
            </section>

            <section class="card">
                <h3 style="color: #fff;">Buat Transaksi</h3>
                <div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center; margin-top: 15px;">
                    <div><label style="color:#00F39C;">Pengirim:</label><select id="senderSelect" style="padding:8px;"></select></div>
                    <div><label style="color:#00F39C;">Penerima:</label><select id="recipientSelect" style="padding:8px;"></select></div>
                    <div><label style="color:#00F39C;">Jumlah:</label><input type="number" id="amountInput" min="1" placeholder="0" style="padding:8px; width:80px;"></div>
                    <button id="addTransactionButton" class="main-button">Kirim</button>
                </div>
                <div id="transactionStatus" style="margin-top: 10px; color: #fff;"></div>
            </section>
            
            <section class="card">
                <h3 style="color: #fff;">Transaksi Pending (Mempool)</h3>
                <div id="pendingContainer" style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 5px; min-height: 50px;">
                    <p class="no-pending" style="color: #ccc; font-style: italic;">Tidak ada transaksi.</p>
                </div>
                <button id="mineAllButton" class="main-button" style="background: #27ae60; margin-top: 15px; width: 100%;" disabled>Mine Semua Transaksi</button>
                <div id="miningResult" style="margin-top: 10px; font-weight: bold; color: #fff;"></div>
            </section>

            <h2 style="margin-top: 40px; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 20px;">Rantai Blok Konsensus</h2>
            <div id="consensusChainContainer" style="display: flex; flex-wrap: wrap; gap: 20px;"></div>

            <section class="card explanation-content" style="background: rgba(10, 14, 39, 0.8); backdrop-filter: blur(10px); padding: 30px; border-radius: 10px; margin-top: 50px;">
                <h2 style="text-align: left; margin-bottom: 10px;">Pembelajaran & Cara Menggunakan</h2>
                
                <h3>Cara Menggunakan</h3>
                <ol>
                    <li><strong>Cek Saldo:</strong> Lihat saldo awal 3 user (A, B, C) masing-masing 100 koin.</li>
                    <li><strong>Kirim Transaksi:</strong> Pilih pengirim, penerima, dan jumlah. Klik kirim. Transaksi akan masuk ke "Pending" (Mempool). Saldo belum berkurang permanen.</li>
                    <li><strong>Mining Konsensus:</strong> Klik "Mine Semua Transaksi". Sistem akan memaketkan transaksi ke dalam blok baru, melakukan Proof-of-Work, dan menyetujui perubahan saldo secara permanen di seluruh jaringan.</li>
                </ol>

                <h3>Konsep Teknis: Distributed Ledger</h3>
                <ul>
                    <li><strong>Mempool (Memory Pool):</strong> Ruang tunggu transaksi sebelum divalidasi dan dimasukkan ke blok.</li>
                    <li><strong>Double Spending Prevention:</strong> Sistem mengecek saldo pengirim sebelum mengizinkan transaksi masuk ke Mempool. Jika saldo kurang, transaksi ditolak.</li>
                    <li><strong>Finality:</strong> Transaksi baru dianggap sah dan final setelah blok berhasil di-mine dan ditambahkan ke rantai.</li>
                </ul>
            </section>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script src="js/consensus_logic.js"></script>
</body>
</html>